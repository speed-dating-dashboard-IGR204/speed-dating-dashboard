import pandas as pd
import numpy as np

dic_coor = {'lat': [41.8755616,
  33.2588817,
  41.6500201,
  31.8160381,
  43.90825,
  39.5162234,
  34.044146350000005,
  51.5073219,
  33.772179449999996,
  37.78441041175343,
  -34.9964963,
  52.5310214,
  34.044146350000005,
  39.1014537,
  25.7741728,
  45.4668,
  32.3293809,
  40.7127281,
  36.7014631,
  38.8949924,
  40.0757384,
  42.2681569,
  22.2793278,
  40.7127281,
  41.9216734,
  36.7014631,
  41.1763139,
  46.3144754,
  38.8949924,
  42.3602534,
  38.8949924,
  40.0757384,
  43.6211955,
  1.357107,
  -10.3333333,
  42.36650945,
  39.1014537,
  40.7127281,
  34.0536909,
  37.7790262,
  35.000074,
  37.7790262,
  39.3260685,
  31.5313113,
  46.7985624,
  42.6384261,
  42.6384261,
  31.5313113,
  39.9527237,
  29.7589382,
  39.9527237,
  40.6501038,
  42.3602534,
  40.7127281,
  36.7014631,
  27.7567667,
  40.0757384,
  46.3144754,
  46.3144754,
  40.0757384,
  33.2095614,
  35.0841034,
  37.4443293,
  40.7127281,
  42.3602534,
  22.5000485,
  33.8358492,
  38.6529545,
  51.5073219,
  42.3602534,
  45.9896587,
  42.3602534,
  41.8755616,
  39.3260685,
  39.9527237,
  40.2253569,
  45.9896587,
  40.2253569,
  10.0788118,
  35.000074,
  31.8160381,
  47.2868352,
  8.559559,
  39.3260685,
  34.395342,
  44.9772995,
  40.0757384,
  43.1561681,
  31.5313113,
  35.000074,
  36.7014631,
  37.7790262,
  52.5310214,
  24.4768783,
  40.85149705,
  -34.9964963,
  40.6501038,
  39.1014537,
  40.7127281,
  31.5313113,
  22.3511148,
  61.0666922,
  41.8755616,
  38.7251776,
  31.8160381,
  31.8160381,
  42.2681569,
  39.3260685,
  22.2793278,
  42.2681569,
  12.7503486,
  40.0757384,
  43.0349931,
  40.7127281,
  40.6501038,
  46.603354,
  40.85149705,
  18.2214149,
  40.85149705,
  35.1490215,
  40.85149705,
  30.8703881,
  39.5162234,
  40.5834557,
  40.7127281,
  42.3788774,
  41.6500201,
  40.0757384,
  51.48172305,
  40.7127281,
  34.0536909,
  35.000074,
  43.1561681,
  42.6978634,
  46.3144754,
  40.7127281,
  51.4820845,
  23.9739374,
  51.0,
  2.8894434,
  36.7014631,
  41.000028,
  8.559559,
  45.9896587,
  40.7127281,
  40.7127281,
  39.9348351,
  44.9772995,
  40.7127281,
  45.421106,
  35.000074,
  35.000074,
  40.7127281,
  39.9527237,
  33.7849591,
  41.5051613,
  40.5834557,
  38.9953683,
  35.6729639,
  40.7944504,
  61.0666922,
  45.9896587,
  34.0536909,
  42.3315509,
  38.8949924,
  38.7251776,
  37.8753497,
  42.8867166,
  22.3511148,
  46.603354,
  51.5073219,
  40.0757384,
  40.9699889,
  40.2253569,
  36.7014631,
  32.7174202,
  40.7127281,
  36.7014631,
  23.9739374,
  40.6501038,
  40.0757384,
  41.32373,
  41.7370229,
  40.7498243,
  38.27312,
  40.7127281,
  33.7489924,
  -32.8755548,
  40.3936294,
  41.6500201,
  34.0536909,
  40.7127281,
  40.7127281,
  43.157285,
  25.0375198,
  37.8753497,
  35.000074,
  40.7127281,
  35.1345127,
  40.7127281,
  39.008641100000006,
  42.0850747,
  33.4415086,
  52.5310214,
  4.6125522,
  40.0757384,
  8.559559,
  40.7127281,
  33.7489924,
  42.6073975,
  40.7127281,
  42.075346,
  39.9527237,
  39.2908816,
  37.7790262,
  29.7589382,
  52.4379589,
  39.3260685,
  4.6533326,
  22.3511148,
  51.0834196,
  38.8949924,
  59.6749712,
  2.8894434,
  40.4416941,
  40.7127281,
  51.0834196,
  40.7127281,
  42.3315509,
  34.0536909,
  38.8949924,
  51.5117166,
  37.1232245,
  42.3602534,
  40.3270127,
  34.0536909,
  44.4308975,
  47.3752671,
  40.7127281,
  40.7127281,
  -32.8755548,
  45.5202471,
  47.6038321,
  38.0464066,
  40.6501038,
  31.2322758,
  37.7790262,
  -31.7613365,
  43.6659541,
  31.5313113,
  22.5000485,
  36.5748441,
  40.0149856,
  39.5162234,
  -12.544455500000002,
  43.1561681,
  47.6038321,
  31.8160381,
  42.3788774,
  43.1561681,
  52.2319581,
  40.6501038,
  38.91089915,
  40.7127281,
  40.7127281,
  23.9739374,
  31.8160381,
  40.0757384,
  43.6534817,
  40.7127281,
  40.7127281,
  49.8167003,
  22.5000485,
  60.0,
  34.5370339,
  41.6500201,
  42.3602534,
  36.1672559,
  47.4979937,
  64.6863136,
  55.09485385,
  42.3602534,
  64.9841821,
  1.4317107500000001,
  64.6863136,
  28.1083929,
  38.8949924,
  36.7014631,
  31.5313113,
  40.0757384,
  40.7127281,
  40.08852665,
  40.7127281,
  34.395342,
  40.7127281,
  31.8160381,
  42.8867166,
  39.5162234,
  42.8867166,
  38.8949924,
  40.85149705,
  40.6501038,
  43.1561681,
  12.7503486,
  23.9739374,
  37.1232245,
  42.3750997,
  40.7127281,
  40.0757384,
  40.7127281,
  40.7127281,
  42.3602534,
  28.6138954,
  43.1561681,
  39.9527237,
  42.6384261,
  45.421106,
  40.0757384,
  40.9699889,
  48.8183247,
  29.5498845,
  23.9739374,
  42.1294712,
  40.7127281,
  40.9118753,
  31.9510266,
  40.7127281,
  40.8006567,
  34.0222263,
  40.0757384,
  36.5748441,
  45.5202471,
  43.1561681,
  43.6211955,
  25.7741728,
  32.7762719,
  19.0759899,
  46.3144754,
  46.3144754,
  40.0757384,
  37.4443293,
  40.7127281,
  34.5708167,
  40.6501038,
  46.3144754,
  38.91089915,
  36.7014631,
  40.7127281,
  40.0757384,
  23.9739374,
  23.9739374,
  23.9739374,
  40.7896239,
  40.0757384,
  40.9699889,
  33.7849591,
  34.0143928,
  36.7014631,
  28.6138954,
  40.8783886,
  39.3260685,
  36.2206081,
  25.7741728,
  46.603354,
  -24.7761086,
  43.6534817,
  55.27324,
  42.3602534,
  40.7127281,
  41.8755616,
  43.411391,
  10.2735633,
  36.638392,
  23.04123655,
  34.0536909,
  40.7127281,
  44.4308975,
  40.7127281,
  41.8755616,
  36.7014631,
  40.7127281,
  42.3788774,
  41.6500201,
  43.9792797,
  40.7127281,
  40.0757384,
  37.7790262,
  36.73612,
  22.2793278,
  39.5162234,
  40.7127281,
  40.85149705,
  37.7884969,
  34.0536909,
  34.0140805,
  40.0757384,
  42.6384261,
  41.8755616,
  42.6384261,
  51.0834196,
  36.638392,
  48.8566969,
  46.603354,
  40.7127281,
  44.9772995,
  40.0757384,
  40.7127281,
  46.603354,
  30.2711286,
  38.8949924,
  40.0757384,
  42.4792618,
  40.0757384,
  33.7849591,
  25.7741728,
  48.2663013,
  40.7127281,
  38.7251776,
  40.3270127,
  36.7014631,
  27.7567667,
  61.0666922,
  33.8439408,
  40.7127281,
  40.0757384,
  36.7014631,
  40.7127281,
  40.4416941,
  36.7014631,
  34.044146350000005,
  40.9946622,
  35.1345127,
  39.5162234,
  40.0757384,
  36.7014631,
  35.6729639,
  36.7014631,
  39.2908816,
  45.4668,
  42.3602534,
  52.215933,
  40.7127281,
  34.0536909,
  44.4761601,
  4.6533326,
  22.3511148,
  40.7127281,
  40.7127281,
  1.357107,
  1.35862245,
  1.357107,
  31.2322758,
  36.7014631,
  22.3511148,
  40.0757384,
  34.4221319,
  22.2793278,
  40.7127281,
  39.1014537,
  22.3511148,
  52.197584649999996,
  35.000074,
  1.357107,
  40.7127281,
  30.6771945,
  27.9595523,
  42.3691372,
  35.6828387,
  33.6874388,
  33.7147613,
  36.7014631,
  50.6402809,
  33.2588817,
  37.7790262,
  36.7014631,
  61.0666922,
  38.8949924,
  38.7251776,
  40.0757384,
  41.1763139,
  27.7567667,
  45.9852129,
  34.0536909,
  40.7474966,
  2.8894434,
  40.0757384,
  22.3511148,
  38.9953683,
  40.08852665,
  40.0757384,
  40.7127281,
  12.7503486,
  42.3602534,
  25.7741728,
  40.3270127,
  42.3602534,
  39.2908816,
  40.7127281,
  39.100105,
  40.7263224,
  42.3602534,
  36.7014631,
  39.5162234,
  14.5907332,
  36.7014631,
  27.7567667,
  40.7127281,
  36.7216841,
  -31.7613365,
  22.3511148,
  52.197584649999996,
  27.7567667,
  40.7127281,
  38.27312,
  36.7014631,
  22.5000485,
  32.7174202,
  42.3602534,
  19.58726775,
  40.7596198,
  40.9699889,
  35.000074,
  43.6211955,
  41.3149011,
  40.0757384,
  36.7014631,
  40.7127281,
  22.3125986,
  35.000074,
  39.906217,
  36.7014631,
  38.9953683,
  24.4768783,
  39.5162234,
  42.6384261,
  37.7790262,
  53.5823404,
  64.6863136,
  32.6475314,
  -2.4833826,
  40.573895300000004,
  32.7174202,
  37.7790262,
  40.7127281,
  44.40726,
  45.4668,
  51.0834196,
  42.6384261,
  54.7023545,
  51.540089699999996,
  46.603354],
 'lon': [-87.6244212,
  -86.8295337,
  -72.7342163,
  -99.5120986,
  -69.9616745820036,
  -76.9382069,
  -118.24466336743033,
  -0.1276474,
  -116.49529769785079,
  -122.43564417808469,
  -64.9672817,
  -1.2649062,
  -118.24466336743033,
  -84.5124602,
  -80.19362,
  9.1905,
  -83.1137366,
  -74.0060152,
  -118.755997,
  -77.0365581,
  -74.4041622,
  -83.7312291,
  114.1628131,
  -74.0060152,
  -93.3122705,
  -118.755997,
  -73.7907554,
  11.0480288,
  -77.0365581,
  -71.0582912,
  -77.0365581,
  -74.4041622,
  -84.6824346,
  103.8194992,
  -53.2,
  -71.2580196483813,
  -84.5124602,
  -74.0060152,
  -118.242766,
  -122.419906,
  104.999927,
  -122.419906,
  -4.8379791,
  34.8667654,
  8.2319736,
  12.674297,
  12.674297,
  34.8667654,
  -75.1635262,
  -95.3676974,
  -75.1635262,
  -73.9495823,
  -71.0582912,
  -74.0060152,
  -118.755997,
  -81.4639835,
  -74.4041622,
  11.0480288,
  11.0480288,
  -74.4041622,
  -87.5675258,
  -106.650985,
  -122.1598465,
  -74.0060152,
  -71.0582912,
  -100.0000375,
  -118.3406288,
  -90.24111656024635,
  -0.1276474,
  -71.0582912,
  -94.6113288,
  -71.0582912,
  -87.6244212,
  -4.8379791,
  -75.1635262,
  -82.6881395,
  -94.6113288,
  -82.6881395,
  -68.1517339,
  104.999927,
  -99.5120986,
  -120.212613,
  -81.1308434,
  -4.8379791,
  -111.763275,
  -93.2654692,
  -74.4041622,
  -75.8449946,
  34.8667654,
  104.999927,
  -118.755997,
  -122.419906,
  -1.2649062,
  90.2932426,
  -73.0994258107431,
  -64.9672817,
  -73.9495823,
  -84.5124602,
  -74.0060152,
  34.8667654,
  78.6677428,
  -107.991707,
  -87.6244212,
  -105.607716,
  -99.5120986,
  -99.5120986,
  -83.7312291,
  -4.8379791,
  114.1628131,
  -83.7312291,
  122.7312101,
  -74.4041622,
  -87.922497,
  -74.0060152,
  -73.9495823,
  1.8883335,
  -73.0994258107431,
  -66.41328179513847,
  -73.0994258107431,
  -90.0516285,
  -73.0994258107431,
  -92.007126,
  -76.9382069,
  -74.1496048,
  -74.0060152,
  -72.032366,
  -72.7342163,
  -74.4041622,
  3.65253315,
  -74.0060152,
  -118.242766,
  104.999927,
  -75.8449946,
  23.3221789,
  11.0480288,
  -74.0060152,
  -0.0045417,
  120.9820179,
  10.0,
  -73.783892,
  -118.755997,
  19.9999619,
  -81.1308434,
  -94.6113288,
  -74.0060152,
  -74.0060152,
  -75.0307264,
  -93.2654692,
  -74.0060152,
  -75.690308,
  104.999927,
  104.999927,
  -74.0060152,
  -75.1635262,
  -84.442163,
  -81.6934446,
  -74.1496048,
  21.9877132,
  -79.0392919,
  -77.8616386,
  -107.991707,
  -94.6113288,
  -118.242766,
  -83.0466403,
  -77.0365581,
  -105.607716,
  -122.23963364918777,
  -78.8783922,
  78.6677428,
  1.8883335,
  -0.1276474,
  -74.4041622,
  -77.7278831,
  -82.6881395,
  -118.755997,
  -117.1627728,
  -74.0060152,
  -118.755997,
  120.9820179,
  -73.9495823,
  -74.4041622,
  63.9528098,
  -99.5873816,
  -73.7976337,
  -98.5821872,
  -74.0060152,
  -84.3902644,
  -56.0201525,
  47.7872508,
  -72.7342163,
  -118.242766,
  -74.0060152,
  -74.0060152,
  -77.615214,
  121.5636796,
  -122.23963364918777,
  104.999927,
  -74.0060152,
  33.9225856,
  -74.0060152,
  -77.02063116905664,
  -76.053813,
  -94.4196452,
  -1.2649062,
  13.1535811,
  -74.4041622,
  -81.1308434,
  -74.0060152,
  -84.3902644,
  25.4856617,
  -74.0060152,
  -73.601633,
  -75.1635262,
  -76.610759,
  -122.419906,
  -95.3676974,
  13.4468721,
  -4.8379791,
  -74.083652,
  78.6677428,
  10.4234469,
  -77.0365581,
  14.5208584,
  -73.783892,
  -79.9900861,
  -74.0060152,
  10.4234469,
  -74.0060152,
  -83.0466403,
  -118.242766,
  -77.0365581,
  -0.105857,
  -78.4927721,
  -71.0582912,
  -86.1746933,
  -118.242766,
  -89.6884637,
  -109.638757,
  -74.0060152,
  -74.0060152,
  -56.0201525,
  -122.6741949,
  -122.3300624,
  -84.4970393,
  -73.9495823,
  121.4692071,
  -122.419906,
  -71.3187697,
  -79.41475,
  34.8667654,
  -100.0000375,
  139.2394179,
  -105.270545,
  -76.9382069,
  131.0183706011867,
  -75.8449946,
  -122.3300624,
  -99.5120986,
  -72.032366,
  -75.8449946,
  21.0067249,
  -73.9495823,
  -77.03595104778171,
  -74.0060152,
  -74.0060152,
  120.9820179,
  -99.5120986,
  -74.4041622,
  -79.3839347,
  -74.0060152,
  -74.0060152,
  15.4749544,
  -100.0000375,
  100.0,
  -86.3944308,
  -72.7342163,
  -71.0582912,
  -115.148516,
  19.0403594,
  97.7453061,
  82.90999918242298,
  -71.0582912,
  -18.1059013,
  103.61240064154529,
  97.7453061,
  84.0917139,
  -77.0365581,
  -118.755997,
  34.8667654,
  -74.4041622,
  -74.0060152,
  -74.68458580402051,
  -74.0060152,
  -111.763275,
  -74.0060152,
  -99.5120986,
  -78.8783922,
  -76.9382069,
  -78.8783922,
  -77.0365581,
  -73.0994258107431,
  -73.9495823,
  -75.8449946,
  122.7312101,
  120.9820179,
  -78.4927721,
  -71.1056157,
  -74.0060152,
  -74.4041622,
  -74.0060152,
  -74.0060152,
  -71.0582912,
  77.2090057,
  -75.8449946,
  -75.1635262,
  12.674297,
  -75.690308,
  -74.4041622,
  -77.7278831,
  2.1301998,
  -98.5324331,
  120.9820179,
  -80.0852695,
  -74.0060152,
  -73.821074,
  -102.16763,
  -74.0060152,
  -73.7284647,
  -118.4051088,
  -74.4041622,
  139.2394179,
  -122.6741949,
  -75.8449946,
  -84.6824346,
  -80.19362,
  -96.7968559,
  72.8773928,
  11.0480288,
  11.0480288,
  -74.4041622,
  -122.1598465,
  -74.0060152,
  -105.993007,
  -73.9495823,
  11.0480288,
  -77.03595104778171,
  -118.755997,
  -74.0060152,
  -74.4041622,
  120.9820179,
  120.9820179,
  120.9820179,
  -73.9598939,
  -74.4041622,
  -77.7278831,
  -84.442163,
  -117.898451,
  -118.755997,
  77.2090057,
  -73.89095497482518,
  -4.8379791,
  -86.69563733154433,
  -80.19362,
  1.8883335,
  134.755,
  -79.3839347,
  -1.6999854,
  -71.0582912,
  -74.0060152,
  -87.6244212,
  -106.280075,
  -84.0739102,
  127.6961188,
  -81.52614194734898,
  -118.242766,
  -74.0060152,
  -89.6884637,
  -74.0060152,
  -87.6244212,
  -118.755997,
  -74.0060152,
  -72.032366,
  -72.7342163,
  -120.737257,
  -74.0060152,
  -74.4041622,
  -122.419906,
  -79.920116,
  114.1628131,
  -76.9382069,
  -74.0060152,
  -73.0994258107431,
  -122.3558473,
  -118.242766,
  -117.9038141,
  -74.4041622,
  12.674297,
  -87.6244212,
  12.674297,
  10.4234469,
  127.6961188,
  2.3514616,
  1.8883335,
  -74.0060152,
  -93.2654692,
  -74.4041622,
  -74.0060152,
  1.8883335,
  -97.7436995,
  -77.0365581,
  -74.4041622,
  -71.1522766,
  -74.4041622,
  -84.442163,
  -80.19362,
  7.7199956,
  -74.0060152,
  -105.607716,
  -86.1746933,
  -118.755997,
  -81.4639835,
  -107.991707,
  9.400138,
  -74.0060152,
  -74.4041622,
  -118.755997,
  -74.0060152,
  -79.9900861,
  -118.755997,
  -118.24466336743033,
  -73.8785922,
  33.9225856,
  -76.9382069,
  -74.4041622,
  -118.755997,
  -79.0392919,
  -118.755997,
  -76.610759,
  9.1905,
  -71.0582912,
  19.134422,
  -74.0060152,
  -118.242766,
  -73.212906,
  -74.083652,
  78.6677428,
  -74.0060152,
  -74.0060152,
  103.8194992,
  103.93147757443202,
  103.8194992,
  121.4692071,
  -118.755997,
  78.6677428,
  -74.4041622,
  -119.7026673,
  114.1628131,
  -74.0060152,
  -84.5124602,
  78.6677428,
  0.13915373736874398,
  104.999927,
  103.8194992,
  -74.0060152,
  -99.5771398,
  -82.4264959,
  -83.076381,
  139.7594549,
  -80.4363743,
  -117.7902856,
  -118.755997,
  4.6667145,
  -86.8295337,
  -122.419906,
  -118.755997,
  -107.991707,
  -77.0365581,
  -105.607716,
  -74.4041622,
  -73.7907554,
  -81.4639835,
  24.6859225,
  -118.242766,
  -74.2635376,
  -73.783892,
  -74.4041622,
  78.6677428,
  21.9877132,
  -74.68458580402051,
  -74.4041622,
  -74.0060152,
  122.7312101,
  -71.0582912,
  -80.19362,
  -86.1746933,
  -71.0582912,
  -76.610759,
  -74.0060152,
  -94.5781416,
  -73.9864498,
  -71.0582912,
  -118.755997,
  -76.9382069,
  120.9809674,
  -118.755997,
  -81.4639835,
  -74.0060152,
  -4.4287244,
  -71.3187697,
  78.6677428,
  0.13915373736874398,
  -81.4639835,
  -74.0060152,
  -98.5821872,
  -118.755997,
  -100.0000375,
  -117.1627728,
  -71.0582912,
  -155.42688965312746,
  -111.8867975,
  -77.7278831,
  104.999927,
  -84.6824346,
  -74.12503520754366,
  -74.4041622,
  -118.755997,
  -74.0060152,
  113.91732378641939,
  104.999927,
  116.3912757,
  -118.755997,
  21.9877132,
  90.2932426,
  -76.9382069,
  12.674297,
  -122.419906,
  16.52852627853657,
  97.7453061,
  54.5643516,
  117.8902853,
  -74.32547702638871,
  -117.1627728,
  -122.419906,
  -74.0060152,
  8.9338624,
  9.1905,
  10.4234469,
  12.674297,
  -3.2765753,
  0.08192645651586072,
  1.8883335]}

def var_binaire(note):
    if note > 5:
        return 1
    else:
        return 0


def income_cat(income):
    incomeF = float(str(income).replace(',', ''))
    if incomeF < 50000.00:
        return 'medium'
    elif incomeF < 110000.00:
        return 'rich'
    else:
        return 'very rich'


def discretize_age(age):
    """ 4 classe d'age pour echantillon homogène"""
    if age < 23 :
        return 0
    elif age < 26 :
        return 1
    elif age < 29 :
        return 2
    else :
        return 3

def is_tuition(tuition):
    if tuition >0:
        return 1
    else:
        return 0


def cleanDF(df_Speedating):
    #df_Speedating['imprelig']=df_Speedating['imprelig'].apply(lambda x : var_binaire(x))
    df_Speedating['sports']=df_Speedating['sports'].apply(lambda x : var_binaire(x))
    df_Speedating['tvsports']=df_Speedating['tvsports'].apply(lambda x : var_binaire(x))
    df_Speedating['exercise']=df_Speedating['exercise'].apply(lambda x : var_binaire(x))
    df_Speedating['dining']=df_Speedating['dining'].apply(lambda x : var_binaire(x))
    df_Speedating['museums']=df_Speedating['museums'].apply(lambda x : var_binaire(x))
    df_Speedating['hiking']=df_Speedating['hiking'].apply(lambda x : var_binaire(x))
    df_Speedating['clubbing']=df_Speedating['clubbing'].apply(lambda x : var_binaire(x))
    df_Speedating['tv']=df_Speedating['tv'].apply(lambda x : var_binaire(x))
    df_Speedating['theater']=df_Speedating['theater'].apply(lambda x : var_binaire(x))
    df_Speedating['movies']=df_Speedating['movies'].apply(lambda x : var_binaire(x))
    df_Speedating['concerts']=df_Speedating['concerts'].apply(lambda x : var_binaire(x))
    df_Speedating['shopping']=df_Speedating['shopping'].apply(lambda x : var_binaire(x))
    df_Speedating['yoga']=df_Speedating['yoga'].apply(lambda x : var_binaire(x))
    df_Speedating['income']=df_Speedating['income'].apply(lambda x : income_cat(x))
    df_Speedating['age_class'] = df_Speedating['age'].apply(lambda x: discretize_age(x))
    df_Speedating['tuition_bin'] = df_Speedating['tuition'].apply(lambda x: is_tuition(float(str(x).replace(',',''))))
    df_Speedating['total'] = df_Speedating[['attr_o', 'sinc_o', 'intel_o', 'fun_o', 'amb_o', 'shar_o']].sum(axis=1)
    df_Speedating['attr_o_100'] = df_Speedating['attr_o'] / df_Speedating['total'] * 100
    df_Speedating['sinc_o_100'] = df_Speedating['sinc_o'] / df_Speedating['total'] * 100
    df_Speedating['intel_o_100'] = df_Speedating['intel_o'] / df_Speedating['total'] * 100
    df_Speedating['fun_o_100'] = df_Speedating['fun_o'] / df_Speedating['total'] * 100
    df_Speedating['amb_o_100'] = df_Speedating['amb_o'] / df_Speedating['total'] * 100
    df_Speedating['shar_o_100'] = df_Speedating['shar_o'] / df_Speedating['total'] * 100


    return df_Speedating


def get_df_users(df_Speedating):
    df_user = (
        df_Speedating[["iid", "age_class", "field_cd", "race", "goal", "date", "go_out", "career"]]
        .groupby("iid")
        .first()
        .reset_index()
    )

    df_user['lat'] = dic_coor['lat']
    df_user['lon'] = dic_coor['lon']

    return df_user

def df_hobbies_creation(df_sous_Speed):
    df_hobbies = df_sous_Speed.drop_duplicates(subset='iid').reset_index(drop=True)[
        ['sports', 'tvsports', 'exercise', 'dining', 'museums', 'hiking', 'clubbing', 'tv', 'theater', 'movies', 'concerts', 'shopping',
         'yoga']]
    return df_hobbies



